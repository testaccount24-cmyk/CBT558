* GET UCB ADDRESS FOR DASD VOLSER (OR TAPE VOLSER, FOR THAT MATTER)
*
* YOU CAN CHANGE THE FIRST OPERAND FROM VOLSER=XXXX TO DEVN=YYYY,
*   WHERE YYYY IS A HALFWORD CONTAINING THE BINARY UNIT ADDRESS, IF
*   YOU WANT TO RETRIEVE A UCB BY DEVICE NUMBER.
*
UCB2     SMODE KEY=0,STATE=S
         UCBLOOK VOLSER=VOLSERXX,   RX-ADDR OF TARGET VOLSER           X
               UCBPTR=LUCBADDR,     UCB ADDRESS WILL BE HERE IF FOUND  X
               LOC=ANY,             UCB'S ABOVE 16M LINE OK            X
               NOPIN,               DO NOT PIN THE UCB                 X
               DYNAMIC=YES,         DYNAMIC UCB'S ARE ALLOWED          X
               DEVCLASS=DASDTAPE,   CODE JUST DASD OR TAPE TO RESTRICT X
               RANGE=ALL            4-DIGIT UCB'S ARE OK
*
         LR    R3,R0             SAVE UCB ADDRESS
         LR    R4,R15            SAVE RETCODE
         SMODE KEY=N,STATE=P ,   BACK TO NORMAL
         LTR   R4,R4             ALL IS WELL?
         BNZ   NOTFOUND
*
FOUNDIT  L     R6,LUCBADDR       @ OF UCB - MAY BE ABOVE 16M!
         USING UCB,R6
*
VOLSERXX DC    CL6'SYSRES'
LUCBADDR DC    A(0)

