LISTPSWD SVLNK R3
 OPEN (SYSPRINT,OUTPUT,DADCB)
 L R1,DADCB+44
 MVC DASRCH(4),38(R1)
*
*
*
READ EXCP DAIOB
 WAIT ECB=DAECB
 CLI DAECB,X'7F'
 BNE EOJ
 MVC DSN,KEYDSN
 MVC PSWD,KEYPSWD
 LH R1,RECOUNT
 CVD R1,WRK
 MVC COUNT,=X'402020202020'
 ED COUNT,WRK+5
 MVC RDONLY(2),=C'C/'
 TM RECTYP,X'80'
 BO RDWT
 MVI RDONLY,C'S'
RDWT MVC RDONLY+2(7),=C'RD-WRT '
  TM RECTYP,X'01'
  BO PUT
  MVC RDONLY+2(7),=C'RD ONLY'
PUT PUT SYSPRINT,LIST
 B READ
*
*
*
EOJ L R13,4(R13)
 LM R14,R12,12(R13)
 BR R14
*
*
*
 DS 0H
KEY DS 0CL52
KEYDSN DS CL44
KEYPSWD DS CL8
RECORD DS 0CL80
RECOUNT DS XL2
RECTYP DS XL1
 DS CL77
*
*
*
LIST DS 0CL80
 DC CL4'DSN='
DSN DS CL37
 DC CL6' PSWD='
PSWD DS CL8
COUNT DS CL6
 DC CL10' CALLS'
RDONLY DS CL9
WRK DS D
*
*
*
CMDCHN CCW X'31',DASRCH,X'40',5
 CCW 8,*-8,0,0
 CCW X'0E',KEY,X'40',132
 CCW X'92',DASRCH,X'20',5
*
*
*
SYSPRINT DCB DSORG=PS,MACRF=PM,DDNAME=SYSPRINT,RECFM=F,LRECL=80,       X
               BLKSIZE=80
DAIOB EXCPIOB CCW=CMDCHN,DDNAME=PASSWORD
 END
